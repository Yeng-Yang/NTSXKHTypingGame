<!DOCTYPE html>
<html lang="lo">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - เบเบฑเบเบเบฒเบเบเบปเบเบเบงเบเบเบฒ</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Phetsarath+OT:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="admin.css">

    <!-- เปเบเบตเปเบก Library SweetAlert2 เปเบเบทเปเบญเบเบฒเบเปเบเปเบเปเบเบทเบญเบเบเบตเปเบชเบงเบเบเบฒเบก -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- เปเบเบตเปเบก Style เบชเบณเบฅเบฑเบเบเบธเปเบก 6 เปเบ -->
    <style>
        .exam-controls-container {
            display: flex;
            gap: 20px; /* เปเบเบตเปเบกเบเปเบญเบเบงเปเบฒเบเบฅเบฐเบซเบงเปเบฒเบเบเบธเปเบก */
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        .hexagon-btn {
            position: relative;
            width: 180px; /* เบเบณเบเบปเบเบเบงเบฒเบกเบเบงเปเบฒเบ */
            height: 156px; /* เบเบฑเบเบเบธเบ: เบเบณเบเบงเบเบเบงเบฒเบกเบชเบนเบเปเบซเปเบเบทเบเบเปเบญเบ (width * 0.866) */
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            line-height: 1.3;
            padding: 0 15px;
            border: none;
            cursor: pointer;
            transition: transform 0.2s ease-in-out;
            /* เบชเปเบฒเบเบฎเบนเบ 6 เปเบ */
            clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
        }
        .hexagon-btn:hover {
            transform: scale(1.05); /* เปเบฎเบฑเบเปเบซเปเบเบธเปเบกเปเบซเบเปเบเบถเปเบเปเบกเบทเปเบญเปเบญเบปเบฒเปเบกเบปเปเบฒเบชเปเปเบเบงเบฒเบ */
        }
    </style>
</head>
<body>

    <!-- เปเบเบตเปเบก Library SheetJS เปเบเบทเปเบญเบเบฑเบเบเบฒเบ Excel -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <!-- เปเบเบตเปเบก Library เบชเบณเบฅเบฑเบเบเบฒเบเบชเปเบฒเบ PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- เปเบซเบผเบ Supabase Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-client-admin.js"></script> <!-- เบเปเบฝเบเบกเบฒเปเบเป Client เบเบญเบ Admin เบเบตเปเบกเบตเบชเบดเบเบเบดเบชเบนเบเบชเบธเบ -->
    <script src="admin_auth.js"></script>

    <script>
        // เบเบงเบเบชเบญเบเบเบฒเบเบฅเบฑเบญเบเบญเบดเบเบเบฑเบเบเบตเบเปเบญเบเบเบตเปเปเบเบทเปเบญเบซเบฒเบเบฐเบเบทเบเบชเบฐเปเบเบ
        // เบเบตเปเปเบเบฑเบเบเบฒเบเบเปเบญเบเบเบฑเบเบเบตเปเบชเบณเบเบฑเบ!
        checkAdminAuth();
    </script>

    <div class="quiz-container">

        <h1>โ๏ธ Admin Panel - เบเบฑเบเบเบฒเบเบเบปเบเบเบงเบเบเบฒ</h1>
        <a href="#" id="logout-btn">เบญเบญเบเบเบฒเบเบฅเบฐเบเบปเบ</a>
        
        <!-- Tab Navigation -->
        <div class="tab-menu">
            <button class="tab-link active" onclick="openTab(event, 'exam-control')">๐น๏ธ เบเบงเบเบเบธเบกเบเบฒเบเบชเบญเบเปเบชเบฑเบ</button>
            <button class="tab-link" onclick="openTab(event, 'create-question')">๐ เบชเปเบฒเบเบเบณเบเบฒเบกเปเปเป</button>
            <button class="tab-link" onclick="openTab(event, 'question-list')">๐ เบฅเบฒเบเบเบฒเบเบเบณเบเบฒเบก</button>
            <button class="tab-link" onclick="openTab(event, 'student-management')">๐งโ๐ เบเบฑเบเบเบฒเบเบเบฑเบเบฎเบฝเบ</button>
            <button class="tab-link" onclick="openTab(event, 'score-summary')">๐ เบชเบฐเบซเบผเบธเบเบเบฐเปเบเบ</button>
            <button class="tab-link" onclick="openTab(event, 'view-reviews')">๐ เปเบเบดเปเบเบเบปเบเบเบงเบเบเบฒ</button>
        </div>

        <!-- Tab Content: Create Question -->
        <div id="create-question" class="tab-content">
            <form id="add-question-form" class="admin-section">
            <h2>๐ เบชเปเบฒเบเบเบณเบเบฒเบกเปเปเป</h2>
            <div class="form-group">
                <label for="q-type">เบเบฐเปเบเบเบเบณเบเบฒเบก:</label>
                <select id="q-type">
                    <option value="multiple-choice">เบเบฒเบฅเบฐเปเบ</option>
                    <option value="fill-in">เบญเบฑเบเบเบฐเปเบ</option>
                    <option value="image-multiple-choice">เบฎเบนเบเบเบฒเบเบเบฒเบฅเบฐเปเบ</option>
                    <option value="image-fill-in">เบฎเบนเบเบเบฒเบเบญเบฑเบเบเบฐเปเบ</option>
                    <option value="matching-text-text">เบเบฑเบเบเบนเป (เบเบปเบงเปเบฑเบเบชเบท-เบเบปเบงเปเบฑเบเบชเบท)</option>
                    <option value="matching-text-image">เบเบฑเบเบเบนเป (เบเบปเบงเปเบฑเบเบชเบท-เบฎเบนเบเบเบฒเบ)</option>
                    <option value="drag-fill-in">เบฅเบฒเบเบเบณเบเบญเบเปเบชเปเบเปเบญเบเบงเปเบฒเบ</option>
                </select>
            </div>
            <div class="form-group">
                <label for="q-class-level">เบฅเบฐเบเบฑเบเบเบฑเปเบ:</label>
                <select id="q-class-level">
                    <option value="เบญเบฒเบเบธเบเบฒเบ 3">เบญเบฒเบเบธเบเบฒเบ 3</option>
                    <option value="เบ.1">เบ.1</option>
                    <option value="เบ.2">เบ.2</option>
                    <option value="เบ.3">เบ.3</option>
                    <option value="เบ.4">เบ.4</option>
                    <option value="เบ.5">เบ.5</option>
                    <option value="เบก.1">เบก.1</option>
                </select>
            </div>
            <div class="form-group">
                <label for="q-text">เบเบณเบเบฒเบก:</label>
                <textarea id="q-text" rows="2"></textarea>
            </div>
            <div class="form-group" id="q-image-group">
                <label for="q-image-upload">เบญเบฑเบเปเบซเบผเบเบฎเบนเบเบเบฒเบ (เบเปเบฒเบกเบต):</label>
                <input type="file" id="q-image-upload" accept="image/*">
                <img id="q-image-preview" src="" alt="เบเบปเบงเบขเปเบฒเบเบฎเบนเบ" style="max-width: 100px; max-height: 100px; display: none; margin-top: 10px; border-radius: 5px;">
            </div>
            <div class="form-group" id="q-options-group">
                <label for="q-options" id="q-options-label">เบเบปเบงเปเบฅเบทเบญเบ (เปเบเบเปเบเปเบฅเบฐเบเบปเบงเปเบฅเบทเบญเบเบเปเบงเบเปเบเบทเปเบญเบเปเบฒเบเบเบธเบ ,):</label>
                <input type="text" id="q-options" placeholder="เบเบปเบงเปเบฅเบทเบญเบ เบ, เบเบปเบงเปเบฅเบทเบญเบ เบ, เบเบปเบงเปเบฅเบทเบญเบ เบ">
                <p class="info-text" id="q-options-info" style="display: none;">เบชเบณเบฅเบฑเบเบเบณเบเบฒเบกเบฅเบฒเบเบเบณเบเบญเบ, เปเบซเปเบเปเบญเบเบชเบฐเปเบเบฒเบฐเบเบณเบเบญเบเบเบปเบงเบซเบผเบญเบ (distractors).</p>
            </div>
            <div class="form-group" id="q-answer-group">
                <label for="q-answer">เบเบณเบเบญเบเบเบตเปเบเบทเบเบเปเบญเบ:</label>
                <p class="info-text" id="q-text-info" style="display: none;">เปเบเบเปเบญเบเบเบณเบเบฒเบก, เปเบซเปเปเบเป `__BLANK__` เปเบเบทเปเบญเบชเปเบฒเบเบเปเบญเบเบงเปเบฒเบ (เบชเบฒเบกเบฒเบเปเบเปเบซเบผเบฒเบเบเปเบญเบเปเบเป). เปเบเบเปเบญเบเบเบณเบเบญเบ, เปเบซเปเบเปเบญเบเบเบณเบเบญเบเบเบฒเบกเบฅเบณเบเบฑเบเบเบญเบเบเปเบญเบเบงเปเบฒเบ เปเบฅเบฐ เปเบเบเบเปเบงเบเปเบเบทเปเบญเบเปเบฒเบเบเบธเบ (,).</p>
                <input type="text" id="q-answer" placeholder="เบเปเบญเบเบเบณเบเบญเบเบเบตเปเบเบทเบเบเปเบญเบเบญเบฑเบเบเบฝเบง">
            </div>
            <div id="matching-pairs-container" class="form-group" style="display: none;">
                <label>เบเบนเปเบเบณเบเบญเบ:</label>
                <div id="matching-pairs-list"></div>
                <button type="button" id="add-pair-btn" style="margin-top: 10px;">+ เปเบเบตเปเบกเบเบนเป</button>
            </div>
            <button id="add-q-btn" class="submit-btn" style="background-color: #28a745;">+ เปเบเบตเปเบกเบเบณเบเบฒเบก</button>
            </form>
        </div>

        <!-- Tab Content: Student Management -->
        <div id="student-management" class="tab-content">
            <div class="admin-section">
            <h2>๐ฅ เปเบเบตเปเบกเบฅเบฒเบเบเบทเปเบเบฑเบเบฎเบฝเบ</h2>
            <div class="form-group">
                <label for="excel-file-input">เปเบฅเบทเบญเบเปเบเบฅเป Excel เปเบเบทเปเบญเบเบณเปเบเบปเปเบฒเบฅเบฒเบเบเบทเป:</label>
                <input type="file" id="excel-file-input" accept=".xlsx, .xls">
                <p class="info-text">
                    <strong>เบเบณเปเบเบฐเบเบณ:</strong> เปเบเบฅเป Excel เบเบงเบเบกเบต <strong>เบฅเบฐเบซเบฑเบเบเบฑเบเบฎเบฝเบ (ID) เบขเบนเปเบเบฑเบเบเบตเบชเบฒเบก (Column C)</strong>.
                </p>
                <div style="margin-top: 10px;">
                    <button type="button" id="download-student-template-btn" class="submit-btn" style="background-color: #17a2b8;">๐ฅ เบเบฒเบงเปเบซเบผเบเปเบเบฅเปเบเบปเบงเบขเปเบฒเบ</button>
                </div>
            </div>
            <div id="students-preview-container" style="margin-top: 15px;"></div>
            <button type="button" id="confirm-import-btn" class="submit-btn" style="display: none; background-color: #28a745; margin-top: 10px;">โ เบขเบทเบเบขเบฑเบเบเบฒเบเบเบณเปเบเบปเปเบฒ</button>
            </div>

            <div class="admin-section">
                <h2>๏ฟฝ๏ธ เปเบเบทเปเบญเบเบกเบทเบเบฑเบเบเบฒเบเบเปเปเบกเบนเบ</h2>
                <button type="button" id="delete-all-students-btn" class="submit-btn" style="background-color: #dc3545; margin-bottom: 15px;">๐๏ธ เบฅเบถเบเบเปเปเบกเบนเบเบเบฑเบเบฎเบฝเบเบเบฑเบเปเบปเบ</button>
                <button type="button" id="delete-all-scores-btn" class="submit-btn" style="background-color: #fd7e14; margin-bottom: 15px;">๐งน เบฅเบถเบเบเปเปเบกเบนเบเบเบฐเปเบเบเบเบฑเบเปเบปเบ</button>
            </div>

            <div class="admin-section">
                <h2>๐ เบฅเบฒเบเบเบทเปเบเบฑเบเบฎเบฝเบเปเบเบฅเบฐเบเบปเบ</h2>
                <div id="student-list-controls" style="margin-bottom: 15px; display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                    <div class="form-group" style="margin-bottom: 0; display: flex; align-items: center;">
                        <label for="student-list-class-level-filter" style="margin-bottom: 0; margin-right: 5px; white-space: nowrap;">เบเบฑเปเบเบเบญเบ:</label>
                        <select id="student-list-class-level-filter" class="form-control" style="width: auto;">
                            <option value="all">เบเบธเบเบเบฑเปเบเบฎเบฝเบ</option>
                            <option value="เบญเบฒเบเบธเบเบฒเบ 3">เบญเบฒเบเบธเบเบฒเบ 3</option>
                            <option value="เบ.1">เบ.1</option>
                            <option value="เบ.2">เบ.2</option>
                            <option value="เบ.3">เบ.3</option>
                            <option value="เบ.4">เบ.4</option>
                            <option value="เบ.5">เบ.5</option>
                            <option value="เบก.1">เบก.1</option>
                        </select>
                    </div>
                    <span>เบชเบฐเปเบเบ: </span>
                    <select id="rows-per-page-select" style="padding: 5px;">
                        <option value="10" selected>10 เปเบเบง</option>
                        <option value="25">25 เปเบเบง</option>
                        <option value="50">50 เปเบเบง</option>
                        <option value="all">เบเบฑเบเปเบปเบ</option>
                    </select>
                    <button id="prev-page-btn" class="submit-btn" style="padding: 5px 10px;" disabled>&lt; เบเปเบญเบเปเปเบฒ</button>
                    <span id="page-info"></span>
                    <button id="next-page-btn" class="submit-btn" style="padding: 5px 10px;" disabled>เปเปเบฒเบเปเปเปเบ &gt;</button>
                </div>
                <div style="margin-top: 15px;">
                    <button id="export-student-list-excel-btn" class="submit-btn" style="background-color: #28a745;">๐ค Export เปเบเบฑเบ Excel</button>
                </div>
                <div id="student-list-no-ranking"></div>
            </div>
        </div>

        <!-- Tab Content: Question List -->
        <div id="question-list" class="tab-content">
            <div class="admin-section">
                <h2>๐ค เบเบณเปเบเบปเปเบฒเบเบณเบเบฒเบกเบเบฒเบ Excel</h2>
                <div class="form-group">
                    <label for="question-import-input">เปเบฅเบทเบญเบเปเบเบฅเป Excel เปเบเบทเปเบญเบเบณเปเบเบปเปเบฒเบเบณเบเบฒเบก:</label>
                    <input type="file" id="question-import-input" accept=".xlsx, .xls">
                </div>
                <div style="margin-top: 10px;">
                    <button type="button" id="download-question-template-btn" class="submit-btn" style="background-color: #17a2b8;">๐ฅ เบเบฒเบงเปเบซเบผเบเปเบเบฅเปเบเบปเบงเบขเปเบฒเบ</button>
                    <button type="button" id="import-questions-btn" class="submit-btn" style="background-color: #28a745; display: none;">โ เบขเบทเบเบขเบฑเบเบเบฒเบเบเบณเปเบเบปเปเบฒเบเบณเบเบฒเบก</button>
                </div>
                <p class="info-text" style="margin-top: 15px;">
                    <strong>เบเบณเปเบเบฐเบเบณ:</strong> เบฎเบญเบเบฎเบฑเบเบชเบฐเปเบเบฒเบฐเบเบณเบเบฒเบกเบเบฐเปเบเบ "เบเบฒเบฅเบฐเปเบ (multiple-choice)" เปเบฅเบฐ "เบญเบฑเบเบเบฐเปเบ (fill-in)" เบเบตเปเบเปเปเบกเบตเบฎเบนเบเบเบฒเบ.
                </p>
            </div>
            <div class="admin-section">
                <h2>๐ เบฅเบฒเบเบเบฒเบเบเบณเบเบฒเบกเบเบฑเบเปเบปเบ</h2>
                <div id="question-list-controls" style="margin-bottom: 15px; display: flex; align-items: center; gap: 15px;">
                    <div class="form-group" style="margin-bottom: 0; display: flex; align-items: center;">
                        <label for="question-list-class-level-filter" style="margin-bottom: 0; margin-right: 5px; white-space: nowrap;">เบเบฑเปเบเบเบญเบ:</label>
                        <select id="question-list-class-level-filter" class="form-control" style="width: auto;">
                            <option value="all">เบเบธเบเบเบฑเปเบเบฎเบฝเบ</option>
                            <option value="เบญเบฒเบเบธเบเบฒเบ 3">เบญเบฒเบเบธเบเบฒเบ 3</option>
                            <option value="เบ.1">เบ.1</option>
                            <option value="เบ.2">เบ.2</option>
                            <option value="เบ.3">เบ.3</option>
                            <option value="เบ.4">เบ.4</option>
                            <option value="เบ.5">เบ.5</option>
                            <option value="เบก.1">เบก.1</option>
                        </select>
                    </div>
                </div>
                <button type="button" id="delete-all-questions-btn" class="submit-btn" style="background-color: #dc3545; margin-bottom: 15px;">๐๏ธ เบฅเบถเบเบเบณเบเบฒเบกเบเบฑเบเปเบปเบ</button>
                <div id="questions-list"></div>
            </div>
        </div>
        
        <!-- Tab Content: Score Summary -->
        <div id="score-summary" class="tab-content">
            <div class="admin-section">
                <h2>๐ เบชเบฐเบซเบผเบธเบเบเบฐเปเบเบ เปเบฅเบฐ เบเบฒเบเบเบฑเบเบญเบฑเบเบเบฑเบ (เบเบฐเปเบเบเบซเบผเปเบฒเบชเบธเบ)</h2>
                <div style="margin-bottom: 25px; display: flex; gap: 20px; align-items: flex-end; border-bottom: 1px solid #eee; padding-bottom: 20px;">
                    <div class="form-group" style="margin-bottom: 0;">
                        <label for="score-summary-class-level">เบเบฑเปเบเบเบญเบเบเบฒเบกเบเบฑเปเบเบฎเบฝเบ:</label>
                        <select id="score-summary-class-level" class="form-control">
                            <option value="all">เบเบฑเบเปเบปเบ</option>
                            <option value="เบญเบฒเบเบธเบเบฒเบ 3">เบญเบฒเบเบธเบเบฒเบ 3</option>
                            <option value="เบ.1">เบ.1</option>
                            <option value="เบ.2">เบ.2</option>
                            <option value="เบ.3">เบ.3</option>
                            <option value="เบ.4">เบ.4</option>
                            <option value="เบ.5">เบ.5</option>
                            <option value="เบก.1">เบก.1</option>
                        </select>
                    </div>
                    <button id="print-summary-btn" class="submit-btn" style="background-color: #007bff;">๐จ๏ธ เบเบดเบก</button>
                </div>
                <div id="ranked-summary-content">
                    <!-- Ranked summary table will be rendered here -->
                </div>
            </div>
        </div>

        <!-- Tab Content: View Student Reviews -->
        <div id="view-reviews" class="tab-content">
            <div class="admin-section">
                <h2>๐ เปเบเบดเปเบเบเบปเบเบเบงเบเบเบฒเบเบญเบเบเบฑเบเบฎเบฝเบ (เบเบปเบเบซเบผเปเบฒเบชเบธเบ)</h2>
                <div id="review-filters" style="display: flex; gap: 20px; align-items: center; margin-bottom: 20px; flex-wrap: wrap;">
                    <div class="form-group" style="margin: 0;">
                        <label for="review-class-level-filter">เบเบฑเปเบเบเบญเบเบเบฒเบกเบเบฑเปเบเบฎเบฝเบ:</label>
                        <select id="review-class-level-filter" class="form-control">
                            <option value="all">เบเบฑเบเปเบปเบ</option>
                            <option value="เบญเบฒเบเบธเบเบฒเบ 3">เบญเบฒเบเบธเบเบฒเบ 3</option>
                            <option value="เบ.1">เบ.1</option>
                            <option value="เบ.2">เบ.2</option>
                            <option value="เบ.3">เบ.3</option>
                            <option value="เบ.4">เบ.4</option>
                            <option value="เบ.5">เบ.5</option>
                            <option value="เบก.1">เบก.1</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin: 0;">
                        <label for="review-student-id-search">เบเบปเปเบเบซเบฒ ID เบเบฑเบเบฎเบฝเบ:</label>
                        <input type="text" id="review-student-id-search" class="form-control" placeholder="เบเปเบญเบ ID...">
                    </div>
                     <button id="export-all-reviews-pdf-btn" class="submit-btn" style="background-color: #fd7e14;">๐ฅ Export เบฅเบงเบกเปเบเบฑเบ PDF</button>
                </div>
                <div id="student-submissions-list"></div>
            </div>
            <div id="student-answer-sheet-container" class="admin-section" style="display: none;"></div>
        </div>

        <!-- Tab Content: Exam Control -->
        <div id="exam-control" class="tab-content" style="display: block;">
            <div class="admin-section">
                <h2>๐น๏ธ เบเบงเบเบเบธเบกเบเบฒเบเบชเบญเบเปเบชเบฑเบ</h2>
                <div id="exam-status-display">เบเบณเบฅเบฑเบเปเบซเบผเบเบชเบฐเบเบฒเบเบฐ...</div>
                <!-- เปเบเบตเปเบก: เบเบทเปเบเบเบตเปเบชเบฐเปเบเบเปเบกเบเบเบฑเบเบเบญเบเบซเบผเบฑเบ -->
                <div id="admin-exam-timer"></div>

                <!-- UI เปเปเปเบชเบณเบฅเบฑเบเบเบฒเบเบเบฑเปเบเปเบงเบฅเบฒ -->
                <div id="exam-config" style="margin-top: 20px; padding: 20px; border: 1px solid #ddd; border-radius: 8px; background-color: #f9f9f9;">
                    <h4 style="margin-top: 0;">เบเบฑเปเบเบเปเบฒเบเบฒเบเบชเบญเบเปเบชเบฑเบ</h4>
                    <div class="config-grid">
                        <div class="form-group" style="flex: 1;">
                            <label for="exam-month">เบเบฐเบเบณเปเบเบทเบญเบ:</label>
                            <input type="text" id="exam-month" class="form-control" placeholder="เบเบปเบงเบขเปเบฒเบ: เปเบเบทเบญเบ 1">
                        </div>
                        <div class="form-group" style="flex: 1;">
                            <label for="exam-year">เบเบฐเบเบณเบเบต:</label>
                            <input type="number" id="exam-year" class="form-control">
                        </div>
                        <div class="form-group" style="flex: 1;">
                            <label for="exam-target-class-level">เบเบฑเปเบเบฎเบฝเบเบเบตเปเบเบฐเบชเบญเบเปเบชเบฑเบ:</label>
                            <select id="exam-target-class-level" class="form-control">
                                <option value="all">เบเบธเบเบเบฑเปเบเบฎเบฝเบ</option>
                                <option value="เบญเบฒเบเบธเบเบฒเบ 3">เบญเบฒเบเบธเบเบฒเบ 3</option>
                                <option value="เบ.1">เบ.1</option>
                                <option value="เบ.2">เบ.2</option>
                                <option value="เบ.3">เบ.3</option>
                                <option value="เบ.4">เบ.4</option>
                                <option value="เบ.5">เบ.5</option>
                                <option value="เบก.1">เบก.1</option>
                            </select>
                        </div>
                        <div class="form-group" style="flex: 1;">
                            <label for="exam-end-time">เปเบงเบฅเบฒเบชเบดเปเบเบชเบธเบ:</label>
                            <input type="datetime-local" id="exam-end-time" class="form-control">
                        </div>
                    </div>
                </div>

                <!-- Manual Controls -->
                <div id="manual-controls" style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                    <div class="exam-controls-container">
                       <button id="open-exam-btn" class="hexagon-btn" style="background-color: #17a2b8;">๐ข เปเบเบตเบเบฎเบฑเบเบเบฑเบเบฎเบฝเบ</button>
                       <button id="start-exam-btn" class="hexagon-btn" style="background-color: #28a745;">๐ เปเบฅเบตเปเบกเบชเบญเบเปเบชเบฑเบ</button>
                       <button id="stop-exam-btn" class="hexagon-btn" style="background-color: #dc3545;">๐ เบขเบธเบเบเบฒเบเบชเบญเบเปเบชเบฑเบ<br>เบเบฑเบเบเบต</button>
                       <button id="close-session-btn" class="hexagon-btn" style="background-color: #6c757d;">๐ช เบเบดเบเบซเปเบญเบเปเบชเบฑเบ<br>(เบซเบผเบฑเบเบชเบญเบเปเบชเบฑเบเปเบฅเปเบง)</button>
                    </div>
                </div>
                <p class="info-text" style="text-align: center; margin-top: 15px;"><strong>เปเบฒเบเปเบซเบ:</strong> เปเบกเบทเปเบญเบเบปเบ "เปเบฅเบตเปเบกเบชเบญเบเปเบชเบฑเบ", เบฅเบฐเบเบปเบเบเบฐเปเบฅเบตเปเบกเบเบฑเบเปเบงเบฅเบฒ เปเบฅเบฐ เบเบฐเบชเบดเปเบเบชเบธเบเปเบเปเบงเบฅเบฒเบเบตเปเบเบณเบเบปเบ. เบเบฑเบเบฎเบฝเบเบเบฐเบเบทเบเบเบฑเบเบเบฑเบเปเบซเปเบชเบปเปเบเบเบณเบเบญเบเปเบกเบทเปเบญเบฎเบญเบเปเบงเบฅเบฒ.</p>
            </div>
            <div id="exam-control-scores" class="admin-section" style="display: none;">
                 <h2>๐ เบชเบฐเบซเบผเบธเบเบเบฐเปเบเบเบซเบผเบฑเบเบชเบดเปเบเบชเบธเบ</h2>
                 <div id="exam-control-scores-content"></div>
            </div>
        </div>

        <!-- Modal for Editing Questions -->
        <div id="edit-question-modal" class="modal">
            <div class="modal-content">
                <h2>โ๏ธ เปเบเปเปเบเบเบณเบเบฒเบก</h2>
                <form id="edit-question-form-modal">
                    <input type="hidden" id="edit-q-id">
                    <div class="form-group">
                        <label for="edit-q-type">เบเบฐเปเบเบเบเบณเบเบฒเบก:</label>
                        <select id="edit-q-type" disabled>
                            <option value="multiple-choice">เบเบฒเบฅเบฐเปเบ</option>
                            <option value="fill-in">เบญเบฑเบเบเบฐเปเบ</option>
                            <option value="image-multiple-choice">เบฎเบนเบเบเบฒเบเบเบฒเบฅเบฐเปเบ</option>
                            <option value="image-fill-in">เบฎเบนเบเบเบฒเบเบญเบฑเบเบเบฐเปเบ</option>
                            <option value="matching-text-text">เบเบฑเบเบเบนเป (เบเบปเบงเปเบฑเบเบชเบท-เบเบปเบงเปเบฑเบเบชเบท)</option>
                            <option value="matching-text-image">เบเบฑเบเบเบนเป (เบเบปเบงเปเบฑเบเบชเบท-เบฎเบนเบเบเบฒเบ)</option>
                            <option value="drag-fill-in">เบฅเบฒเบเบเบณเบเบญเบเปเบชเปเบเปเบญเบเบงเปเบฒเบ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="edit-q-class-level">เบฅเบฐเบเบฑเบเบเบฑเปเบ:</label>
                        <select id="edit-q-class-level">
                            <option value="เบญเบฒเบเบธเบเบฒเบ 3">เบญเบฒเบเบธเบเบฒเบ 3</option>
                            <option value="เบ.1">เบ.1</option>
                            <option value="เบ.2">เบ.2</option>
                            <option value="เบ.3">เบ.3</option>
                            <option value="เบ.4">เบ.4</option>
                            <option value="เบ.5">เบ.5</option>
                            <option value="เบก.1">เบก.1</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="edit-q-text">เบเบณเบเบฒเบก:</label>
                        <textarea id="edit-q-text" rows="2"></textarea>
                    </div>
                    <div class="form-group" id="edit-q-image-group">
                        <label>เบฎเบนเบเบเบฒเบเบเบฑเบเบเบธเบเบฑเบ:</label>
                        <img id="edit-q-image-preview" src="" style="max-width: 100px; max-height: 100px; display: none; margin-bottom: 10px;">
                        <label for="edit-q-image-upload">เบเปเบฝเบเบฎเบนเบเบเบฒเบ (เปเบฅเบทเบญเบเบเปเบฒเบเปเบญเบเบเบฒเบเบเปเบฝเบ):</label>
                        <input type="file" id="edit-q-image-upload" accept="image/*">
                        <input type="hidden" id="edit-q-original-image-url">
                    </div>
                    <div class="form-group" id="edit-q-options-group">
                        <label for="edit-q-options" id="edit-q-options-label">เบเบปเบงเปเบฅเบทเบญเบ (เปเบเบเบเปเบงเบ ,):</label>
                        <input type="text" id="edit-q-options">
                        <p class="info-text" id="edit-q-options-info" style="display: none;">เบชเบณเบฅเบฑเบเบเบณเบเบฒเบกเบฅเบฒเบเบเบณเบเบญเบ, เปเบซเปเบเปเบญเบเบชเบฐเปเบเบฒเบฐเบเบณเบเบญเบเบเบปเบงเบซเบผเบญเบ (distractors).</p>
                    </div>
                    <div class="form-group" id="edit-q-answer-group">
                        <label for="edit-q-answer">เบเบณเบเบญเบเบเบตเปเบเบทเบเบเปเบญเบ:</label>
                        <p class="info-text" id="edit-q-text-info" style="display: none;">เปเบเบเปเบญเบเบเบณเบเบฒเบก, เปเบซเปเปเบเป `__BLANK__` เปเบเบทเปเบญเบชเปเบฒเบเบเปเบญเบเบงเปเบฒเบ. เปเบเบเปเบญเบเบเบณเบเบญเบ, เปเบซเปเบเปเบญเบเบเบณเบเบญเบเบเบฒเบกเบฅเบณเบเบฑเบเบเบญเบเบเปเบญเบเบงเปเบฒเบ เปเบฅเบฐ เปเบเบเบเปเบงเบเปเบเบทเปเบญเบเปเบฒเบเบเบธเบ (,).</p>
                        <input type="text" id="edit-q-answer">
                    </div>
                    <div id="edit-matching-pairs-container" class="form-group" style="display: none;">
                        <label>เบเบนเปเบเบณเบเบญเบ:</label>
                        <div id="edit-matching-pairs-list"></div>
                        <button type="button" id="edit-add-pair-btn" style="margin-top: 10px;">+ เปเบเบตเปเบกเบเบนเป</button>
                    </div>
                    <button type="submit" class="submit-btn">เบเบฑเบเบเบถเบเบเบฒเบเบเปเบฝเบเปเบเบ</button>
                    <button type="button" id="close-modal-btn" class="submit-btn" style="background-color: #6c757d; margin-top: 10px;">เบเบปเบเปเบฅเบตเบ</button>
                </form>
            </div>
        </div>

    </div>

    <script src="admin.js"></script>
</body>
</html>
